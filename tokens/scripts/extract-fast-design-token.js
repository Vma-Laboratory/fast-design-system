/* eslint-disable no-console */
const StyleDictionaryPackage = require("style-dictionary");
const tokens = require("../figma/output/all.json");

module.exports = function () {
  /**
   * Custom format that generate file with all the design tokens
   */
  StyleDictionaryPackage.registerFormat({
    name: "fast/design-tokens",
    formatter({ dictionary }) {
      return (
        "/* DO NOT EDIT THIS FILE ! */\n" +
        "/* This file has been generated by the pipeline*/\n\n" +
        "import { DesignToken } from '@microsoft/fast-foundation';\n\n" +
        "const { create } = DesignToken;\n\n" +
        `${dictionary.allProperties
          .map(
            (token) =>
              `export const ${token.name} = create<string>('${token.name}');`
          )
          .join("\n")}\n`
      );
    },
  });

  console.log(`\nProcessing:  [Extract Fast Design Token]`);
  const StyleDictionary = StyleDictionaryPackage.extend({
    tokens,
    platforms: {
      web: {
        transformGroup: "web",
        prefix: "fpsfa",
        buildPath: "./src/",
        files: [
          {
            destination: `design-token.ts`,
            format: "fast/design-tokens",
          },
        ],
        transforms: ["name/cti/camel"],
      },
    },
  });
  StyleDictionary.buildPlatform("web");
  console.log("\nEnd processing");
};
